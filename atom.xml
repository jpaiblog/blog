<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Cognitive Services Support Blog</title>
  
  
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="https://jpaiblog.github.io/"/>
  <updated>2020-03-02T07:08:40.189Z</updated>
  <id>https://jpaiblog.github.io/</id>
  
  <author>
    <name>jpaiblog</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>UWF を有効化した環境でメモリ ダンプを取得する方法</title>
    <link href="https://jpaiblog.github.io/2020/02/12/QNA-management-service/"/>
    <id>https://jpaiblog.github.io/2020/02/12/QNA-management-service/</id>
    <published>2020-02-11T15:00:00.000Z</published>
    <updated>2020-03-02T07:08:40.189Z</updated>
    
    <content type="html"><![CDATA[<p>UWF を有効化した環境で、メモリ ダンプを取得する方法についてご紹介します。</p><a id="more"></a><br><hr><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><ul><li><p>概要  </p><p> 強制メモリ ダンプを取得することで、現象発生時のメモリの状態を Memory.dmp ファイルとして保存し、そこから現象発生時のオペレーティング システムのメモリの状態や、行われていた処理などの詳細を確認することができます。  </p></li><li><p>影響  </p><p> メモリ ダンプ取得のためのシャットダウン操作は、正常にシステムを停止させる方法ではないことを予めご留意ください。システムが正常に動作しない問題の調査方法として、他に方法が無い場合にご案内させていただいております。運用環境で、且つ回避策がある場合には、極力実施をお勧めいたしません。  </p></li><li><p>再起動の必要性  </p><p> 事前準備時、メモリダンプ採取時に再起動が必要です。  </p></li><li><p>採取ファイル  </p><p>本手順では “D:\Dumps\Memory.dmp” として進めさせていただきます。  </p></li></ul><hr><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><ul><li><p>システム ドライブ以外に、メモリ ダンプを保存するボリュームを追加し、いずれかのドライブとしてマウントします。<br>※ この手順では D: ドライブとします。  </p></li><li><p>事前に UWF フィルターとボリュームの保護を実行します。この過程で PageFile の設定が一旦初期化されます。<br>実行例:<br>uwfmgr.exe filter enable<br>uwfmgr.exe volume protect c:<br>shutdown -r -t 0<br>※ この手順ではシステム ドライブを C: ドライブとします。  </p></li></ul><hr><h2 id="Dump-出力設定手順"><a href="#Dump-出力設定手順" class="headerlink" title="Dump 出力設定手順"></a>Dump 出力設定手順</h2><ul><li><p>(1) UWF フィルターを無効化する。  </p><p> 実行例:<br> uwfmgr.exe filter disable  </p></li><li><p>(2) PageFile の大きさを 物理メモリ + 300 Mbyte 以上の大きさに設定する。  </p><p> 実行例:<br> a) [エクスプローラ] - [コンピュータ] を右クリックし [プロパティ(R)] をクリックします。<br> b) [システムの詳細設定] をクリックします。<br> c) [詳細設定] タブの [パフォーマンス] にある [設定(S)] をクリックします。<br> d) [詳細設定] タブの [仮想メモリ] の項目にある [変更(C)] ボタンをクリックします。<br> e) この画面にて、[すべてのドライブのページング ファイルのサイズを自動的に管理する(A)] オプションを外します。<br> f) 手順 1) で作成したシステムドライブ以外のドライブ (ここでは D:) をクリックします。<br> g) [カスタムサイズ] にチェックを付け、[初期サイズ]、[最大サイズ] の両方に物理メモリ + 300 Mbyte 以上の値を入力します。 (例えば 4096MB メモリの場合、4396MB)<br> h) その後 [設定] ボタンをクリックし設定を反映させ [OK] ボタンをクリックします。<br> i) “変更結果はコンピューターを再起動しなければ有効になりません。” というポップアップが表示されますので、[OK] ボタンをクリックします。<br> j) “パフォーマンス オプション” のウィンドウも [OK] ボタンにて閉じます。  </p><p> ※ 補足<br> この設定値は、次のレジストリに反映されます。なお、直接レジストリ値を編集することでも、ページング ファイル サイズを設定することができます。  </p><p> キー: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SessionManager\MemoryManagement<br> 名前: PagingFiles<br> 種類: REG_MULTI_SZ<br> データ: &lt;ページ ファイル保存先&gt; &lt;初期サイズ (MB)&gt; &lt;最大サイズ (MB)&gt; (設定例: d:\pagefile.sys 4396 4396)</p></li><li><p>(3) 完全メモリ ダンプ (Full Dump) が生成されるよう設定する。  </p><p> a) [エクスプローラ] - [コンピュータ] を右クリックし、[プロパティ] をクリックします。<br> b) 左ペインにある [システムの詳細設定] をクリックします。<br> c) “システムのプロパティ” の [詳細設定] タブの [起動と回復] 枠内にある [設定] ボタンをクリックします。<br> d) “起動と回復” の [デバッグ情報の書き込み] 枠内にあるプルダウン メニューから [完全メモリ ダンプ] を選択し、[OK] ボタンを 2 回クリックします。  </p></li><li><p>(4) [ダンプ ファイル] のパスを変更する。  </p><p> ※ 注意<br> GUI から [完全メモリ ダンプ] を選択する事と併せて、以下のレジストリ エディタで、次のレジストリの値が設定されている事をご確認ください。  </p><p> キー: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\CrashControl<br> 名前: CrashDumpEnabled<br> 種類: REG_DWORD<br> データ: 1  </p><p> メモリ ダンプの出力先は、次のレジストリ値で確認できます。  </p><p> キー: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\CrashControl<br> 名前: DumpFile<br> 種類: REG_EXPAND_SZ<br> データ(既定値): D:\Dumps\MEMORY.DMP  </p></li><li><p>(5) DedicatedDumpFile.sys を設定する。  </p><p> レジストリ エディタで、次のレジストリの値を設定してください。  </p><p> キー: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CrashControl<br> 名前: DedicatedDumpFile<br> 種類: 文字列値<br> データ: D:\dedicateddumpfile.sys  </p><p> キー: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CrashControl<br> 名前: DumpFileSize<br> 種類: REG_DWORD<br> データ: &lt;10 進数でメモリサイズ + 300 MB を設定ください&gt; (設定例: 4396)  </p></li><li><p>(6: オプション) AlwaysKeepMemoryDump を設定する。  </p><p> Client OS におけるメモリ ダンプでは WorkGroup 環境の場合、ダンプ ファイル格納ボリュームの空き容量が25 GB 未満の場合、ダンプ ファイルが削除される動作となります (Domain 環境の場合、25 GB の制限には合致いたしません)。<br> そのため、対象の端末が Workgroup 環境の場合には、以下のレジストリ値を設定いただき、ダンプ ファイルが上記制限に合致しないよう設定いただく事をご検討いただければと存じます。  </p><p> キー: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CrashControl<br> 名前: AlwaysKeepMemoryDump<br> 種類: REG_DWOD<br> データ : 1  </p><p> 公開情報:<br> <a href="https://blogs.msdn.microsoft.com/wer/2009/02/09/kernel-dump-storage-and-clean-up-behavior-in-windows-7/" target="_blank" rel="noopener">Kernel dump storage and clean up behavior in Windows 7</a>  </p></li><li><p>(7: オプション) キーボードから STOP エラーを発生できるように設定する。  </p><p> 事象発生時にメモリ ダンプの生成を行えるよう、トリガーの設定を行います。レジストリ エディタで、次のレジストリの値を設定してください。  </p><p> &lt;PS/2 キーボードの場合&gt;<br> キー: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\i8042prt\Parameters<br> 名前: CrashOnCtrlScroll<br> 種類: REG_DWORD<br> データ: 1  </p><p> &lt;USB キーボードの場合&gt;<br> キー: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\kbdhid\Parameters<br> 名前: CrashOnCtrlScroll<br> 種類: REG_DWORD<br> データ: 1  </p></li><li><p>(8: オプション) NMI スイッチを使用できるように設定する。  </p><p> Windows の機能ではなく、ご使用のハードウェアにメモリ ダンプ取得のための NMI (Non-Maskable Interrupt) スイッチが備わっている場合、以下にご案内するキーボードでクラッシュさせる方法よりも割り込みレベルが高いため、ご使用いただくことをお勧めします。<br> ご使用のハードウェアに当該機能が備わっているか、また、使用方法につきましては、ハードウェアの取扱説明書、あるいはハードウェアご提供元様にご確認ください。  </p><p> また、Windows 側の設定として、レジストリ エディタで、次のレジストリの値を設定ください。  </p><p> キー: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CrashControl<br> 名前: NMICrashDump<br> 種類: REG_DWORD<br> データ: 1  </p></li><li><p>(9) UWF を有効化し、OS を再起動する。</p><p> 実行例:<br> uwfmgr.exe filter enable<br> shutdown -r -t 0  </p></li></ul><hr><h2 id="Dump-の出力手順"><a href="#Dump-の出力手順" class="headerlink" title="Dump の出力手順"></a>Dump の出力手順</h2><p>調査対象の事象が発生した際に、NMI もしくはキーボード操作によってメモリ ダンプを出力させます。  </p><ul><li>取得対象: “D:\Dumps\Memory.dmp”  </li></ul><hr><h2 id="※-参考情報"><a href="#※-参考情報" class="headerlink" title="※ 参考情報"></a>※ 参考情報</h2><ul><li><p><a href="http://support.microsoft.com/kb/969028" target="_blank" rel="noopener">Windows Server 2008 および Windows Server 2008 R2 でカーネルまたは完全メモリ ダンプ ファイルを生成する方法</a>  </p></li><li><p><a href="http://support.microsoft.com/kb/254649/en-us" target="_blank" rel="noopener">Overview of memory dump file options for Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008, Windows 7 and Windows Server 2008 R2</a>  </p></li><li><p><a href="http://support.microsoft.com/kb/254649/ja" target="_blank" rel="noopener">メモリ ダンプ ファイルのオプションは、Windows 2000、Windows XP、Windows Server 2003、Windows Vista、Windows Server 2008、Windows 7 と Windows サーバー 2008 R2 の概要 (機械翻訳)</a>  </p></li><li><p><a href="http://blogs.technet.com/b/askcore/archive/2012/09/12/windows-8-and-windows-server-2012-automatic-memory-dump.aspx" target="_blank" rel="noopener">Windows 8 and Windows Server 2012: Automatic Memory Dump (英文のみ)</a></p></li><li><p><a href="http://support.microsoft.com/kb/2750146" target="_blank" rel="noopener">NMI_HARDWARE_FAILURE error when an NMI is triggered on Windows 8 and Windows Server 2012 (英文のみ)</a>  </p></li><li><p><a href="http://support.microsoft.com/kb/244139" target="_blank" rel="noopener">Windows の機能により、キーボード操作で Memory.dmp ファイルを作成できる</a>  </p></li><li><p><a href="http://support.microsoft.com/kb/130536" target="_blank" rel="noopener">クラッシュ後 Windows でメモリ ダンプ ファイルが保存されない</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;UWF を有効化した環境で、メモリ ダンプを取得する方法についてご紹介します。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Unified Write Filter" scheme="https://jpaiblog.github.io/categories/Unified-Write-Filter/"/>
    
    
      <category term="メモリ ダンプの設定手順" scheme="https://jpaiblog.github.io/tags/%E3%83%A1%E3%83%A2%E3%83%AA-%E3%83%80%E3%83%B3%E3%83%97%E3%81%AE%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86/"/>
    
  </entry>
  
  <entry>
    <title>過去ブログについて</title>
    <link href="https://jpaiblog.github.io/2020/01/12/past-blog/"/>
    <id>https://jpaiblog.github.io/2020/01/12/past-blog/</id>
    <published>2020-01-11T15:00:00.000Z</published>
    <updated>2020-01-21T11:49:29.002Z</updated>
    
    <content type="html"><![CDATA[<p>過去のブログ情報を紹介いたします。</p><a id="more"></a><h2 id="Cognitive-Services"><a href="#Cognitive-Services" class="headerlink" title="Cognitive Services"></a>Cognitive Services</h2><ul><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/255a225d-24e5-4e21-ad28-7fab33088131/translator-text-api-?forum=cognitivesupportteamja" target="_blank" rel="noopener">Translator Text API の翻訳文字数の確認方法</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/fee57b8d-8d08-4036-9d2e-ad4f48812624/open-api-testing-console?forum=cognitivesupportteamja" target="_blank" rel="noopener">Open API Testing Console</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/9555e55e-2af0-4130-948a-74ee3f6d349e/http-401-access-denied-invalid-subscription-key-?forum=cognitivesupportteamja" target="_blank" rel="noopener">HTTP 401 Access Denied (invalid subscription key) のエラーが発生した場合の切り分け方法</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/9586428d-1ad8-4838-bac8-b37da05d9d47/cognitive-services-?forum=cognitivesupportteamja" target="_blank" rel="noopener">Cognitive Services の料金について</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/1fc6d90a-f335-4a51-bbb4-7c168bf8358e/luis-wwwluisai-?forum=cognitivesupportteamja" target="_blank" rel="noopener">LUIS ポータル (www.luis.ai) にサインインできない場合の対処方法</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/bcf0ea4b-04f2-4b81-9963-34d85b3594ef/qna-maker-api-v4-azure-search-?forum=cognitivesupportteamja" target="_blank" rel="noopener">QnA Maker API V4 (一般公開版) の Azure Search に関するよくあるご質問</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/d4235f66-2c6d-4ad8-87ba-ec859e5bb33f/-custom-vision-service-?forum=cognitivesupportteamja" target="_blank" rel="noopener">非管理テナントのアカウントで Custom Vision Service のポータルにサインインできない場合の対処方法</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/d1b413b3-d0a7-4fb9-9938-01a52cb5f914/qna-maker-api-v4-?forum=cognitivesupportteamja" target="_blank" rel="noopener">QnA Maker API V4 (一般公開版) のよくあるご質問</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/e9917891-e99e-481f-a32a-34f853fdd22b/bing-speech-api-api-10-15-?forum=cognitivesupportteamja" target="_blank" rel="noopener">Bing Speech API の新規 API キー作成は 10 月 15 日で終了しました</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/5b3b97c3-532e-489c-b0cb-5546a2988427/cognitive-services-?forum=cognitivesupportteamja" target="_blank" rel="noopener">Cognitive Services の技術サポートのお問い合わせ方法</a></li><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/ecab7e31-dddb-48bf-8a8f-7a9f347ae1b5/cognitive-services-tls-12-?forum=cognitivesupportteamja" target="_blank" rel="noopener">Cognitive Services への接続には TLS 1.2 をご利用ください</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;過去のブログ情報を紹介いたします。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Cognitive Services 全般" scheme="https://jpaiblog.github.io/categories/Cognitive-Services-%E5%85%A8%E8%88%AC/"/>
    
    
      <category term="過去ブログ" scheme="https://jpaiblog.github.io/tags/%E9%81%8E%E5%8E%BB%E3%83%96%E3%83%AD%E3%82%B0/"/>
    
  </entry>
  
  <entry>
    <title>jpaiblog について</title>
    <link href="https://jpaiblog.github.io/2020/01/01/about-jpaiblog/"/>
    <id>https://jpaiblog.github.io/2020/01/01/about-jpaiblog/</id>
    <published>2019-12-31T15:00:00.000Z</published>
    <updated>2020-01-10T09:28:32.355Z</updated>
    
    <content type="html"><![CDATA[<p>日本マイクロソフトの Cognitive Serivce に関するサポート情報のブログです。</p><h3 id="公開日"><a href="#公開日" class="headerlink" title="公開日"></a>公開日</h3><p>2020 年 1 月 1 日より公開いたしました。</p><h3 id="活動について"><a href="#活動について" class="headerlink" title="活動について"></a>活動について</h3><p>製品のサポート メンバーによって運用されております。仕様に関する情報やトラブル シューティングの手順、実装におけるワンポイント アドバイスを公開いたします。</p><h3 id="留意事項"><a href="#留意事項" class="headerlink" title="留意事項"></a>留意事項</h3><p>サイトのコンテンツや情報において、可能な限り正確な情報を掲載し、更新するよう努めております。しかしながら、状況の変化や情報が古くなることにより、必ずしもお客様環境に適用できない情報となる場合がございます。恐れ入りますが、予めご留意くださいますようお願い申し上げます。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;日本マイクロソフトの Cognitive Serivce に関するサポート情報のブログです。&lt;/p&gt;
&lt;h3 id=&quot;公開日&quot;&gt;&lt;a href=&quot;#公開日&quot; class=&quot;headerlink&quot; title=&quot;公開日&quot;&gt;&lt;/a&gt;公開日&lt;/h3&gt;&lt;p&gt;2020 年 1 月 1
      
    
    </summary>
    
    
      <category term="Cognitive Services 全般" scheme="https://jpaiblog.github.io/categories/Cognitive-Services-%E5%85%A8%E8%88%AC/"/>
    
    
      <category term="はじめに" scheme="https://jpaiblog.github.io/tags/%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB/"/>
    
  </entry>
  
</feed>
