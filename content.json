{"meta":{"title":"Japan Cognitive Services Support Blog","subtitle":"","description":"","author":"jpaiblog","url":"https://jpaiblog.github.io/blog","root":"/blog/"},"pages":[],"posts":[{"title":"QnA Maker における Excel ファイルの利用について","slug":"QnA-Maker-Import-Excel","date":"2021-02-02T15:00:00.000Z","updated":"2021-02-04T00:10:56.891Z","comments":true,"path":"2021/02/03/QnA-Maker-Import-Excel/","link":"","permalink":"https://jpaiblog.github.io/blog/2021/02/03/QnA-Maker-Import-Excel/","excerpt":"Excel ファイルを利用して日本語の QnA ペアを追加する際の注意事項についてご紹介します。","text":"Excel ファイルを利用して日本語の QnA ペアを追加する際の注意事項についてご紹介します。 Excel ファイルを利用した場合の注意事項Excel ファイルを利用して日本語の漢字を含める質問と回答を登録する際に、以下の図のように、登録された質問と回答の末尾に漢字のふりがなが付いていることがあります。 また、上記の図では、Excel ファイルの 「Prompts」 列に入っている、漢字を含める内容がマルチターンの Prompts として反映されていません。 この事象の原因としては、Excel 上で漢字を入力した際に自動的に付加されたふりがな (ルビ) が QnA Maker によって抽出されたためと想定されます。 日本語の文字列にふりがな (ルビ) を使用する 抜粋：==============================日本語データを入力するために使用された発音文字の文字列は、ルビを適用するために使用されます。 シートのデータを並べ替えると、既定では、日本語データはふりがなによって並べ替えられます。(中略)Excel の日本語バージョンでふりがなを表示し、漢字 (日本語の言語で使用される中国語の文字) を入力すると、自動的にルビ記号がガイドに追加されます。============================== これは以下の図のように、Excel 上で漢字のふりがなを表示することで確認できます。 現状 QnA Maker は Excel のふりがなも抽出するため、Excel が自動的に付与したふりがなを削除しない状態で、QnA Maker ポータルの [+Add file] もしくは [Import knowledge base] の機能で QnA ペアを追加した場合は、漢字のふりがなも質問と回答に含まれます。 対処策としては、Excel ファイルからふりがなを削除することになりますが、以下の図ように、ふりがなを含むセルをコピーして別のセルへ「数式」として貼り付けると、ふりがなの部分はコピーされませんので、一括削除のアイデアとしてご参考ください。 上記のように、ふりがなを削除した状態の Excel ファイルを利用して質問と回答を追加した場合は、以下の通り漢字のふりがなは表示されません。また、Excel の「Prompts」列の内容もマルチターンの Prompts として反映されるようになります。 変更履歴2021/02/03 created by Chao","categories":[{"name":"QNA Maker","slug":"QNA-Maker","permalink":"https://jpaiblog.github.io/blog/categories/QNA-Maker/"}],"tags":[{"name":"QnA ペアの追加","slug":"QnA-ペアの追加","permalink":"https://jpaiblog.github.io/blog/tags/QnA-%E3%83%9A%E3%82%A2%E3%81%AE%E8%BF%BD%E5%8A%A0/"},{"name":"Excel ファイル","slug":"Excel-ファイル","permalink":"https://jpaiblog.github.io/blog/tags/Excel-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB/"}]},{"title":"Webポータル画面が期待通りに表示されない場合の確認方法","slug":"not-expected-display-on-the-webbrowser","date":"2020-11-10T15:00:00.000Z","updated":"2021-02-04T00:10:56.883Z","comments":true,"path":"2020/11/11/not-expected-display-on-the-webbrowser/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/11/11/not-expected-display-on-the-webbrowser/","excerpt":"Webポータル画面が 『プルダウンリストに選択肢が表示されるはずなのに、表示されない』 など、期待通りに表示されない場合に確認するポイントをご紹介します。","text":"Webポータル画面が 『プルダウンリストに選択肢が表示されるはずなのに、表示されない』 など、期待通りに表示されない場合に確認するポイントをご紹介します。 Coginitive Services の一部には、固有のWebポータル画面を持つサービスがあります。Azureポータル画面や、それらサービス固有のWebポータル画面で期待通りの画面表示とならない場合には、まず以下3点のポイントを確認してみてください。（以下の画像は、Metrics Advisor サービスのポータル画面における画面表示例です） Webブラウザの言語翻訳機能の状態を確認する Webブラウザから最新のデータにアクセスして確認する 現在利用しているブラウザ以外のブラウザを使用して確認する Webブラウザの言語翻訳機能の状態を確認するブラウザ上で言語翻訳ツールなどをお使いでしたら、その機能が事象に影響している可能性があります。翻訳機能を使用しない状態で画面表示をご確認ください。 Webブラウザから最新のデータにアクセスして確認するWebブラウザがローカルに保存したキャッシュデータ等を使用しているために、古い状態のデータが画面表示されている可能性があります。 インターネット上の最新のデータにアクセスして画面表示が行えるよう、以下をご確認ください。 (1) Webブラウザのプライベート ブラウジングを用いて確認する プライベート ブラウジングでは、閲覧履歴、ダウンロード履歴、キャッシュ、Cookie などを保存せずにWebサイトを閲覧可能となります。 Microsoft Edge をご利用の場合、以下のドキュメントの手順に添って、InPrivate ブラウズを利用してください。 Microsoft Edge で InPrivate ブラウズを使う Google Chrome をご利用の場合、以下のGoogle社のヘルプドキュメントの手順に添って、シークレットブラウジングを利用してください。 (Google Chrome ヘルプ) シークレット ブラウジング (2) ブラウザのキャッシュを削除してから確認する Microsoft Edge をご利用の場合、以下のドキュメント以下のドキュメントの [キャッシュされたデータとファイル] にて削除してください。 Microsoft Edge の閲覧履歴を表示または削除する Google Chrome をご利用の場合、以下のGoogle社のヘルプドキュメントの手順に添って削除してください。 (Google Chrome ヘルプ) キャッシュと Cookie の消去 現在利用しているブラウザ以外のブラウザを使用して確認する現在利用している Webブラウザ以外のブラウザを使用した場合に、画面表示が変わるかどうかご確認ください。 変更履歴2020/11/11 created by Uehara","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/tags/Cognitive-Services/"}]},{"title":"Azure Private Link を使用して、Private Endpoint 経由で Cognitive Services にアクセスする方法","slug":"use-private-endpoints","date":"2020-11-10T15:00:00.000Z","updated":"2021-02-04T00:10:57.008Z","comments":true,"path":"2020/11/11/use-private-endpoints/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/11/11/use-private-endpoints/","excerpt":"Azure Private Link を使用して、Private Endpoint 経由で Cognitive Services にアクセスする方法を解説します。","text":"Azure Private Link を使用して、Private Endpoint 経由で Cognitive Services にアクセスする方法を解説します。 Private Link を使用した場合、Cognitive Services のリソースを、 パブリック インターネットに 公開せずに利用できるメリットがあります。（Private Link を使用した、より実際的なシステム構成については、Azure ネットワーク サービスの概要：Azure Private Link のドキュメントをご参照ください）本稿では、サンプルとして以下の図のような構成を設定する手順をご紹介します。 CognitiveServices：サポート状況を確認 CognitiveServices：リソースを作成 CognitiveServices：通常の疎通を確認 VNET,Bastion host,およびPrivateEndpoint：リソースを作成 PrivateEndpoint：接続情報の確認 CognitiveServices：ネットワークを制限 PrivateEndpoint+CognitiveServices：アクセスを確認 1.CognitiveServices：サポート状況を確認Cognitive Services のサービスのうち、仮想ネットワーク対応しているサービスを下記のドキュメントのリストで確認します。本稿では、翻訳サービスの Translator API を例として取り上げ、構成を設定していきます。 Configure Azure Cognitive Services virtual networks：Supported regions and service offerings 2020年11月現在、全てのサービスが対応している状況ではないことにご留意ください。 2.CognitiveServices：リソースを作成マルチサービスリソースでは、Private Link が利用できません。以下のリンクから 単一サービスリソースを作成します。 クイックスタート: Azure portal を使用して Cognitive Services リソースを作成する：新しい Azure Cognitive Services リソースを作成する 3.CognitiveServices：通常の疎通を確認Cognitive Services の通常の利用方法、パブリックインターネットを経由した疎通を確認します。 （たとえば、お手元のPCから、以下の PowerShell スクリプトを用いて、Translator API にリクエストを送信し、英語の”Hello”がスペイン語の”Hola”に翻訳されることを確認します） 12345678$contentType &#x3D; &#39;application&#x2F;json&#39; $endpointKey&#x3D;&#39;&lt;your-key&gt;&#39;$region&#x3D;&#39;&lt;your-region&gt;&#39;$uri &#x3D; &#39;https:&#x2F;&#x2F;api.cognitive.microsofttranslator.com&#x2F;translate?api-version&#x3D;3.0&amp;from&#x3D;en&amp;to&#x3D;es&#39;$body &#x3D; &#39;[&#123;&quot;Text&quot;:&quot;Hello&quot;&#125;]&#39;$response &#x3D; Invoke-WebRequest -Headers @&#123;&quot;Ocp-Apim-Subscription-Key&quot;&#x3D;$endpointKey;&quot;Ocp-Apim-Subscription-Region&quot;&#x3D;$region&#125; -Method POST -Uri $uri -body $body -ContentType $contentType$response.Content このスクリプトは以下のドキュメント記載の Curl コマンドを利用したスクリプトを 参考に作成しています。 Translator v3.0：リージョン リソースを使用した認証 4.VNET,Bastionhost,およびPrivateEndpoint：リソースを作成以下のドキュメントの手順に沿って、VNET, Bastion host, および Private Endpoint のリソースを作成します。 クイックスタート: Azure portal を使用してプライベート エンドポイントを作成する ※ 上記ドキュメント内の “プライベート エンドポイントを作成する“ の手順で、下図のように、リソースとして ”CognitiveServices/accounts” を選択します。 この手順が完了すると、以下のように、Cognitive Services のリソースは Internetからも Private Endpoint からもアクセス可能な状態となります。 5.PrivateEndpoint：接続情報の確認作成したプライベートエンドポイントの DNS の構成から、接続情報を確認し、書き留めておきます。 （ご参考） Configure Azure Cognitive Services virtual networks:DNS changes for private endpoints&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD When you create a private endpoint, the DNS CNAME resource record for the Cognitive Services resource is updated to an alias in a subdomain with the prefix ‘privatelink’. When you create a private endpoint, the DNS CNAME resource record for the Cognitive Services resource is updated to an alias in a subdomain with the prefix ‘privatelink’. 94ed51a7ff5056f43a1df2ea96a563a02f9c7077 6.CognitiveServices：ネットワークを制限AzureポータルのTranslator リソースページの”ネットワーク”メニューで規定のネットワーク アクセス ルールを制限します。 この手順が完了すると、以下のように、Cognitive Services のリソースは Internetからはアクセス不可能な状態となります。 手順3 で確認した Cognitive Services の通常の利用方法を再度実行し、パブリックインターネットを経由した利用ができなくなっていることを確認します。 7.PrivateEndpoint+CognitiveServices：アクセスを確認Private Endpoint 経由で Translator REST API が利用できることを確認します。Virtual Network 内の Bastion host から PowerShell で 以下のスクリプトを実行し、手順3と同様の、英語の”Hello”がスペイン語の”Hola”に翻訳されることを確認します。 123456$contentType &#x3D; &#39;application&#x2F;json&#39; $region&#x3D;&#39;japaneast&#39;$uri &#x3D; &#39;https:&#x2F;&#x2F;sr11-translator-eastjpn-privateendpoint-s1.privatelink.cognitiveservices.azure.com&#x2F;translator&#x2F;text&#x2F;v3.0&#x2F;translate?api-version&#x3D;3.0&amp;from&#x3D;en&amp;to&#x3D;es&#39;$body &#x3D; &#39;[&#123;&quot;Text&quot;:&quot;Hello&quot;&#125;]&#39;$response &#x3D; Invoke-WebRequest -Headers @&#123;&quot;Ocp-Apim-Subscription-Key&quot;&#x3D;$endpointKey;&quot;Ocp-Apim-Subscription-Region&quot;&#x3D;$region&#125; -Method POST -Uri $uri -body $body -ContentType $contentType$response.Content このとき、 グローバルエンドポイント (Translator の場合、”api.cognitive.microsofttranslator.com”) へリクエストすることはできません。 前の手順で書き留めたプライベートエンドポイントへリクエストするように記述します。（リソースによって接続情報は異なります。上記のサンプルスクリプトをそのまま実行せず、手順5の方法でそれぞれのプライベートエンドポイントの情報を確認してください） 変更履歴2020/11/11 created by Uehara","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/tags/Cognitive-Services/"}]},{"title":"Face API 顔認識機能をプログラミングせずに利用する方法","slug":"face-identify-without-coding","date":"2020-10-18T15:00:00.000Z","updated":"2021-02-04T00:10:56.861Z","comments":true,"path":"2020/10/19/face-identify-without-coding/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/10/19/face-identify-without-coding/","excerpt":"Face API 顔認識機能を、プログラミングせずに利用する方法をご紹介します。 利用にあたり推奨するサンプル画像 手順概要 手順詳細","text":"Face API 顔認識機能を、プログラミングせずに利用する方法をご紹介します。 利用にあたり推奨するサンプル画像 手順概要 手順詳細 (準備)キーとエンドポイントを確認 Ⅰ-1.グループを登録する Ⅰ-2.グループに対して、人物を登録する Ⅰ-3.学習用画像の準備 Ⅰ-4.人物に対して、学習用画像を登録する Ⅰ-5.モデルの学習 Ⅰ-6.学習結果の確認 Ⅱ-1.顔認識用画像の準備 Ⅱ-2.顔認識の実行 利用にあたり推奨するサンプル画像について利用にあたっては、チュートリアルで利用されているサンプル画像の利用を推奨します。顔認識には一定以上の品質の画像が必要となるため、まずは以下のサンプル画像でお試しをいただければスムーズに確認が進みます。 ai-fundamentals/data/face/wendell （学習する人物画像として利用） https://raw.githubusercontent.com/MicrosoftDocs/ai-fundamentals/master/data/face/wendell/Wendell_01.jpg https://raw.githubusercontent.com/MicrosoftDocs/ai-fundamentals/master/data/face/wendell/Wendell_02.jpg https://raw.githubusercontent.com/MicrosoftDocs/ai-fundamentals/master/data/face/wendell/Wendell_03.jpg ai-fundamentals/data/face/employees.jpg （顔認識対象の画像として利用） https://raw.githubusercontent.com/MicrosoftDocs/ai-fundamentals/master/data/face/employees.jpg 手順概要手順の概要は、以下の表のとおりです。Ⅰ-1 から、Ⅱ-2に至るまで、順に、[API] 列のリンクをクリックして開く リファレンスAPIページ（一部について製品デモページ）での処理実行をお試しください。なお、「Ⅰ-4 学習用画像の登録」（および「Ⅰ-3 学習用画像の準備」）については一括登録が行えないため、学習画像の枚数分、複数回の実行が必要です。 Ⅰ.モデルの学習を行う 手順内容 API 主要な送信パラメータ 主要な受信パラメータ 備考 1.グループを登録する PersonGroup - Create グループID, グループ名 - グループIDはユーザーが任意に設定する 2.グループに対して、人物を登録する PersonGroup Person – Create グループID, 人物名 人物ID 人物IDは自動で設定される 3.学習用画像の準備 Face - Detect 人物画像のURL 顔ID, 画像のURLから顔として認識された領域の座標情報 検出した顔座標が画像上に可視化される利便があるため、デモ画面の利用を推奨 4.人物に対して、学習用画像を登録する PersonGroup Person - Add Face グループID, 人物ID, 人物画像のURL, 人物画像の中の顔領域の座標情報 - 学習用画像の登録は画像1枚ずつの登録。REST APIでは一括登録不可 5.モデルの学習 PersonGroup - Train グループID - - 6.学習結果の確認 PersonGroup - Get Training Status グループID 学習結果状況 - Ⅱ.顔認識を行う 手順内容 API 主要な送信パラメータ 主要な受信パラメータ 備考 1.顔認識用画像の準備 Face - Detect 人物画像のURL 顔ID, 画像のURLから顔として認識された領域の座標情報 自分のキー配下で発行される顔IDを取得するために、リファレンスAPIページを利用 （任意）デモ画面で検出した顔座標状況を確認 2.顔認識の実行 Face - Identify グループID, 顔ID (顔IDごとに) 人物ID, 確度 - 手順詳細以下にご参考まで、2020年10月時点の各手順実行時のスクリーンショットを貼付します。 (準備)キーとエンドポイントを確認Azure ポータル画面のFaceリソース画面で、キーとエンドポイントを確認します。キーは後続の処理で利用するので、その文字列を取り置きます。 Ⅰ-1.グループを登録する(1) リファレンスAPIページにアクセスすると、ページの中ほどにエンドポイントを選択するセクションがあります。前の手順で確認したエンドポイントが記載された青いボックスをクリックして、テスト用ページへ遷移します。 (2) テスト用ページの中ほどに、パラメータを設定するセクションがあります。Ocp-Apim-Subscription-Key には、前の手順で確認したキー情報を設定します。その他項目は、以下の画像のように設定します。 グループID (personGroupId) もグループ名称 (name) も、ユーザーで任意に設定可能です。また、Request body に設定する userData はオプション項目のため、削除せずに付加したままでも構いません。パラメータを設定し終わったら、[Send] ボタンをクリックします。 (3) レスポンスセクションに結果が表示されます。 以下の画像のように [200 OK] と応答があれば問題ありません。処理が成功しています。 Ⅰ-2.グループに対して、人物を登録する（以降、前の手順と重複するエンドポイント選択手順などは割愛します。 ご参考として、リクエストセクションと、レスポンスセクションのスクリーンショットをそれぞれ貼付します） PersonGroup Person – Create ページを開きます。(1) リクエストセクション前の手順で設定したグループIDを入力します。人物名は、ユーザー様で任意に設定可能です（この名称は以降の手順では特に利用しません） (2) レスポンスセクション以降の手順で必要となるため、自動で設定された personId を取り置きます。 Ⅰ-3.学習用画像の準備デモ画面を開き、[Face Detection] デモが選択されていることを確認します。以下の画像のように、画面左下の [画像のURL] 入力項目にURLを入力して [送信] ボタンをクリックします。 画面右側に、顔として認識された領域の座標情報が出力されます。同時に画面左側に、その領域が元の顔画像に青いバウンディングボックスとして可視化されるので、どこが顔として認識されたのかが容易に確認可能です。 次の手順のために、画面右側に出力された座標情報を取り置きます。 Ⅰ-4.人物に対して、学習用画像を登録するPersonGroup Person - Add Face ページを開きます。 (1) リクエストセクションこれまでの手順で設定および取得した、グループIDと人物IDを入力します。また、targetFace には、前の手順で取得した顔として認識された領域の座標情報を入力します。以下のようなフォーマット変換が必要です。 フォーマット変換前 フォーマット（”targetFace=left,top,width,height”）変換後 “faceRectangle”: {“top”: 313,”left”: 205,”width”: 459,”height”: 626}, 205,313,459,626 detectionModelは、現時点で最新の detection_02 バージョンを選択します。 urlには、前の手順と同じ画像のURLを入力します。 (2) レスポンスセクション[200 OK] と応答があれば問題ありません。また、ここで返却される persistedFaceId は以降の手順で利用しません。 Ⅰ-5.モデルの学習PersonGroup - Train ページを開きます。(1) リクエストセクショングループIDを設定します。 (2) レスポンスセクション[202 Accepted]の応答があれば問題ありません。次の手順で、学習の結果を確認します。 Ⅰ-6.学習結果の確認PersonGroup - Get Training Status ページを開きます。(1) リクエストセクショングループIDを設定します。 (2) レスポンスセクション“status”: “succeeded” と返却されていれば問題ありません。 Ⅱ-1.顔認識用画像の準備Face - Detect ページを開きます。(1) リクエストセクションrecognitionModelで、現時点で最新の recognition_03 バージョンを選択します。detectionModelで、現時点で最新の detection_02 バージョンを選択します。urlに顔認識用画像のURLを入力します。 (2) レスポンスセクション次の手順のために、出力されたfaceIdを取り置きます。 ※ 任意手順 デモ画面 で、以下のように顔認識用画像のURLを入力して [送信] し、検出された顔座標の状況を目視確認します。サンプル画像に detection_02 モデルを適用すると、2つの顔が検出されます。 Ⅱ-2.顔認識の実行Face - Identify ページを開きます。(1) リクエストセクションRequest bodyに、以下のように設定します。largePersonGroupId を削除し、personGroupId にキーを変更します。そして、グループIDを入力します。faceIds には、以下のように前の手順で取得した顔IDを入力します。 { “personGroupId“: “groupid01”, “faceIds“: [ “17d2e2a6-c891-4f16-bf6e-14180c9b0e8b”, “a3a2ce7c-3743-4819-ae8f-47d4940bbee5” ], “maxNumOfCandidatesReturned”: 1, “confidenceThreshold”: 0.5} maxNumOfCandidatesReturned などの項目は、既定のままでも、画面に表示されている説明に準じて、値を変更いただいても問題ありません。 (2) レスポンスセクション顔IDごとに、顔認識の結果として、その人物IDと確度（0から1の値をとります）が返却されます。人物IDが返却されない場合は、パラメータセクションで confidenceThreshold に設定した以上の値の確度で認識した人物に該当がなかったことを示します。 以下の画像が示す結果は、検出された2つの顔のうち、1つの顔には該当する登録済人物がおらず、もう1つの顔については 0.94 の確度で登録済の人物が該当するという内容になります。 変更履歴2020/10/19 created by Uehara","categories":[{"name":"Face API","slug":"Face-API","permalink":"https://jpaiblog.github.io/blog/categories/Face-API/"}],"tags":[{"name":"Face API Recognition Identify","slug":"Face-API-Recognition-Identify","permalink":"https://jpaiblog.github.io/blog/tags/Face-API-Recognition-Identify/"}]},{"title":"LUIS オーサリング リソースへの移行について","slug":"LUIS-authoring-resource","date":"2020-06-04T15:00:00.000Z","updated":"2021-02-04T00:10:56.876Z","comments":true,"path":"2020/06/05/LUIS-authoring-resource/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/06/05/LUIS-authoring-resource/","excerpt":"LUIS オーサリング リソースへの移行について、オーサリング リソースの役割および移行による変更点を紹介します。","text":"LUIS オーサリング リソースへの移行について、オーサリング リソースの役割および移行による変更点を紹介します。 現在 LUIS では Azure オーサリング リソースへの移行を進めており、LUIS ポータル 上での通知に加えて、対象ユーザーには個別で移行に関するご案内をしています。この記事では LUIS オーサリング リソースがどのような役割を持っているのか、また、移行を行うことによる変更点を紹介します。 ■LUIS オーサリング リソースの役割これまで LUIS は、利用開始に Azure サブスクリプションを必要としないサービスとして提供されてきました。Azure サブスクリプションをお持ちでなくても、LUIS のアプリケーションを作成することはできますが、実際にアプリケーションを Bot などから利用する場合には、 Azure の LUIS ランタイム (Prediciton) リソースをアプリケーションに紐づけて使用しています。 この場合、LUIS のアプリケーションは LUIS ポータルにサインインした、各ユーザーのアカウント (メールアドレス) に関連付けられています。一方で、ユーザーのメールアドレスに紐づけて管理していることにより、以下のような問題がありました。 LUIS アプリケーションの所有権を他のユーザーに移転できない Azure とは独立したシステムでアクセス権を制御するため統一的な管理が困難 これらの問題を解決するため、LUIS のアプリケーション管理を Azure に統合する方針となり、LUIS オーサリング リソースが導入されました。 オーサリング リソースを使用しない場合と、オーサリング リソースを使用した場合の、アプリケーションの関連付けや共有方法の違いを図にまとめると以下のようになります。 他のユーザーが所有するアプリケーションにアクセスするには、移行前はコラボレーターと呼ばれる機能により、メールアドレス ベースで、アプリごとに設定する必要がありました。 一方で移行すると、 LUIS アプリケーションは LUIS オーサリング リソースに関連付けられ、そのリソースに対するアクセス権を Azure の標準的なロールベースのアクセス制御 (RBAC) で管理できるようになります。 ■ランタイム リソースとオーサリング リソースの関係オーサリング リソースは LUIS アプリケーションを作成・編集するためだけに使用されます。予測エンドポイント API の使用には、引き続き LUIS アプリケーションに関連付けた、ランタイム (Prediciton) リソース、もしくは試用版の API キー (スターター キー) が必要です。この 2 種類のリソースの違いを図にすると以下のようになります。 ここで、オーサリング リソースを作成するリージョンと、ランタイム リソースを作成するリージョンは、顧客データの取り扱いに特別なルールがある地域 (オーストラリア、ヨーロッパ) を除き、異なるリージョンになっていても構いません。 2020 年 6 月 5 日現在、上記 2 つの地域以外のリージョンで LUIS アプリケーションを公開する場合は、オーサリング リソースのリージョンは米国西部のみとなります。公開を行うと、アプリケーションに関連付けられたランタイム リソースのリージョン (図の例では東日本リージョン) に自動で展開されます。 ■関連する公開ドキュメント Azure リソース オーサリング キーに移行する Azure オーサリング リソースに移行するための手順 オーサリング キーとランタイム キー 作成と公開のリージョンと関連付けられているキー ■FAQQ. オーサリング リソースに移行しないとどうなる？A. 2020 年 6 月 5 日現在、オーサリング リソースの移行期限は 2020 年 9 月 30 日となっております。2020 年 10 月 1 日時点で移行されていないアプリケーションはアクセスできなくなる可能性があります。 Q. オーサリングリソースの移行単位は？A. オーサリング リソースへの移行は、 LUIS ポータルにサインインするユーザーアカウント単位です。移行作業では、自身が所有している LUIS アプリケーションを、どのオーサリング リソースに関連付けるかを指定します。組織単位でまとめて実施するような方法はありません。 Q. オーサリング リソースへの移行でダウンタイムが発生する？A. オーサリング リソースに移行しても、LUIS アプリケーションとランタイム リソースの紐づけはそのまま維持されます。移行作業中もエンドポイント API の呼び出しについてダウンタイムは通常発生しません。 Q. オーサリング リソースに移行したら他のユーザーからアプリケーションが見えなくなったA. 移行前のコラボレーターの設定は自動では移行されませんので、移行後に RBAC で適切な権限の再設定が必要です。また RBAC の設定が適切でも、移行していないユーザーは、移行後のアプリケーションを LUIS ポータルで確認することはできません。 Q. LUIS の新規ユーザーはどうなる？A. 2020 年 6 月 5 日現在は LUIS の使用開始時に、アプリケーションの紐づけ先となる LUIS オーサリング リソースを指定するか、オーサリング リソースを利用せず試用版 (スターター キー) を使用するか選択できます。ここでオーサリング リソースを選択しなかった場合は期限までに移行が必要です。 Q. LUIS のアプリケーション単位で他のユーザーと共有したいA. 移行後はオーサリング リソースにアプリケーションが関連付けられます。アクセス権を付与できるのはオーサリング リソース単位で、アプリケーション単位では付与できません。新しいオーサリング リソースを作成して、共有したいアプリケーションのみをインポートすることで、特定のアプリケーションを共有できます。 変更履歴2020/06/05 created by Nakagami","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"LUIS","slug":"LUIS","permalink":"https://jpaiblog.github.io/blog/tags/LUIS/"}]},{"title":"Translator Text API の翻訳文字数の確認方法","slug":"TranslatorTextAPI-char-translated","date":"2020-05-27T15:00:00.000Z","updated":"2021-02-04T00:10:56.969Z","comments":true,"path":"2020/05/28/TranslatorTextAPI-char-translated/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/05/28/TranslatorTextAPI-char-translated/","excerpt":"Translator Text API の翻訳文字数の確認方法と、参考情報をご紹介します。 翻訳文字数データの確認手順 翻訳文字数データをファイルとしてダウンロードする手順 （参考情報）文字数カウント方法に関する公開ドキュメント","text":"Translator Text API の翻訳文字数の確認方法と、参考情報をご紹介します。 翻訳文字数データの確認手順 翻訳文字数データをファイルとしてダウンロードする手順 （参考情報）文字数カウント方法に関する公開ドキュメント 翻訳文字数データの確認手順(1) Azure Portal 上で、対象のTranslator Text API のリソースを選択します。(2) [監視] ブレードの [メトリック] をクリックします。(3) 表示された、画面中央の [メトリック] から [Characters Translated] を選択します。 (4) 画面右上にある [現地時刻: 過去 24 時間 (自動)] をクリックし、表示されたポップアップから希望の時間範囲と粒度を設定します。 (5) グラフ上に指定した期間の翻訳文字数が表示されます。 (6) グラフの中で確認したい時点にカーソルをあてると、その時間帯（指定した時間の粒度単位）に絞って、翻訳文字数を表示することができます。 翻訳文字数のグラフを表示する際に設定したメトリック [Characters Translated] の説明は、下記の公開ドキュメントを参照ください。 Supported metrics with Azure Monitor #Microsoft.CognitiveServices/accounts Characters Translated Total number of characters in incoming text request. 翻訳文字数データをファイルとしてダウンロードする手順(1) “１．翻訳文字数データの確認手順” に沿って、翻訳文字数のグラフを表示します。(2) 表示された翻訳文字数のグラフ上部の [共有] プルダウンから [Excelへのダウンロード] を選択します。 (3) 翻訳文字数のグラフを表示する際に設定した “メトリック”, “時間の範囲および粒度” のデータのExcelファイルがダウンロードされます。 （参考情報）文字数カウント方法に関する公開ドキュメントどのようにAPIが呼び出されるかによって、カウントされる文字数は変わります。例えば、1文字入力の場合でも、その後ろに空白が付与されたままの状態のテキストがAPIに渡された場合、空白も含めた文字数がカウントされます。‘A’ のような状態では、1文字とカウントされますが、後ろに3つ空白を付与した ‘A ’ のような状態の場合は、4文字とカウントされます。空白の他にも、カウントされる対象がございますので、文字数カウント方法に関する詳細は、下記の公開ドキュメントをご確認ください。 Translator Text API の文字数のカウント方法 変更履歴2020/05/28 created by Uehara","categories":[{"name":"Translator Text API","slug":"Translator-Text-API","permalink":"https://jpaiblog.github.io/blog/categories/Translator-Text-API/"}],"tags":[{"name":"Translator Text API","slug":"Translator-Text-API","permalink":"https://jpaiblog.github.io/blog/tags/Translator-Text-API/"}]},{"title":"Azure の関連ポータル サイトで一部の Azure サブスクリプションやリソースが表示されない事象の原因と対処策","slug":"cognitive-portal-sub-not-found","date":"2020-05-13T15:00:00.000Z","updated":"2021-02-04T00:10:56.839Z","comments":true,"path":"2020/05/14/cognitive-portal-sub-not-found/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/05/14/cognitive-portal-sub-not-found/","excerpt":"Azure の関連ポータル サイトで Azure サブスクリプションやリソースが表示されない原因と対処策について解説します。","text":"Azure の関連ポータル サイトで Azure サブスクリプションやリソースが表示されない原因と対処策について解説します。 Azure で提供されているサービスの一部は、Azure ポータル以外に独自のポータル サイトを提供しています。より具体的に Cognitive Services を例に挙げると以下のようなポータル サイトが存在します。 QnA Maker: https://www.qnamaker.ai/ Custom Vision: https://www.customvision.ai/ Speech Services: https://speech.microsoft.com/ LUIS: https://www.luis.ai/ これらのポータル サイトは Azure と連携しており、サインインしたユーザーの Azure サブスクリプションやリソースを、ポータル内で表示・操作することができます。 しかしながら、例えば、以下のように複数の Azure AD ディレクトリ (contoso.onmicrosoft.com と fabrikam.onmicrosoft.com) に関連付けられているユーザー アカウント (user@contoso.onmicrosoft.com) があるとします。この場合、ロールベースのアクセス制御 (RBAC) の設定が適切でも、上記のポータル サイトでサブスクリプションやリソースが表示されないことがあります。 ■原因これらのポータルサイトへ Azure AD の組織アカウントでアカウントサインインする場合、特定の Azure AD ディレクトリに依存しない common エンドポイント (login.microsoftonline.com/common/…) が使用されます。この時、サインイン先となるのは、ホーム ディレクトリ (上記の図では ディレクトリ A の contoso.onmicrosoft.com) となります。通常はこの挙動で問題になることはありません。 しかし、別のディレクトリにゲスト ユーザーとして招待されることで、複数のディレクトリと関連付けられている場合、ホーム ディレクトリ以外のディレクトリ (上記の図では Bの fabrikam.onmicrosoft.com) に対するサインインは行われないため、そのディレクトリに対するアクセス トークンは取得されません。それにより、ポータルサイト上ではディレクトリ B に紐づいたサブスクリプションやリソースが表示されない事象が発生します。これは Azure AD ディレクトリへのサインインを伴うアクセス権の管理上想定される動作です。 ■対処策ディレクトリ B に関連付けられた Azure サブスクリプションに対するアクセス トークンを取得するには、ディレクトリ B へのサインインを明示的に完了する必要があります。 方法 1. ポータル サイト内でディレクトリを変更するポータル サイトによっては、サイト内でディレクトリを切り替える機能が用意されています。この機能を利用してディレクトリ B に切り替えます。 例. Custom Vision ポータル: これはディレクトリ (テナント) 固有のサインイン エンドポイント (login.microsoftonline.com/&lt;テナント ID またはテナント名&gt;/…) を使用してサインインすることで実現されています。 ご参考: Azure AD のサインイン エンドポイント 方法 2. Azure ポータルでディレクトリを変更するポータル サイト内でディレクリを切り替える機能が用意されていない場合は、Azure ポータル (https://portal.azure.com) を使ってディレクトリの切り替えを行います。そして、各サービスのポータルサイト (QnA Maker など) にアクセスします。 特にディレクトリ B で多要素認証 (MFA) が強制されているなどサインイン方法に制約がある場合は、こちらの方法をお試しください。 Azure ポータルでのディレクトリの切り替え方法は次の手順のようになります。 Azure ポータルの画面右上のユーザーアイコンから「ディレクトリの切り替え」を選択します Azure サブスクリプションが存在するディレクトリを選択してサインインを完了します Web ブラウザーの別のタブで対象のポータル サイト (例. QnA Maker) を開きます もし上記の手順でもポータル サイトで Azure サブスクリプションやリソースが表示されない場合、既定のディレクトリを Azure サブスクリプションが紐づいたディレクトリに変更してから、そのディレクトリに切り替えることで解消するかご確認ください。 ■ 補足ポータル サイト内でディレクトリを切り替える機能が用意されておらず、ホーム ディレクトリでサインインした場合でも、ゲスト ユーザーとして招待されているディレクトリ B に関連付けられた Azure サブスクリプションやリソースがポータル サイト上で表示されることがあります。 これは他のサイト、例えば Azure ポータルでディレクトリ B にサインインしていた場合、ブラウザーにディレクトリ B の認証情報がキャッシュされ、ディレクトリ B に関連付けられた Azure サブスクリプションに対するアクセス トークンを取得できるためです。 ディレクトリ B で多要素認証 (MFA) が強制されているなど、サインイン方法に制約がある場合は、キャッシュされたサインイン情報が有効でないため、方法 2 のように Azure ポータルで MFA などの認証を完了する必要があります。 変更履歴2020/05/14 created by Chao2020/05/14 modified by Nakagami","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"LUIS","slug":"LUIS","permalink":"https://jpaiblog.github.io/blog/tags/LUIS/"},{"name":"QnA Maker","slug":"QnA-Maker","permalink":"https://jpaiblog.github.io/blog/tags/QnA-Maker/"},{"name":"Custom Vision","slug":"Custom-Vision","permalink":"https://jpaiblog.github.io/blog/tags/Custom-Vision/"},{"name":"Speech Services","slug":"Speech-Services","permalink":"https://jpaiblog.github.io/blog/tags/Speech-Services/"}]},{"title":"Cognitive Serivces で使用する API テスト ページについて","slug":"test-APIs","date":"2020-04-30T03:00:00.000Z","updated":"2021-02-04T00:10:56.934Z","comments":true,"path":"2020/04/30/test-APIs/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/04/30/test-APIs/","excerpt":"Cognitive Serivces の API について、テスト実行用の参考サイトを紹介します。","text":"Cognitive Serivces の API について、テスト実行用の参考サイトを紹介します。 はじめに Cognitive Serivces の API は複数あります。どのような API があるかは以下サイトを参照ください。Azure Cognitive Services とは Azure REST API のリファレンス サイトより、Cognitive Services の REST API を確認できます。いくつかのサービスは、こちらのサイトから REST API の実行が可能です。Azure REST API ReferenceAzure Cognitive Services REST API referenceAzure Cognitive Services - Bing Search REST API reference Cognitive Services 関連の API をまとめたサイトにも REST API を実行可能なページが用意されています。https:// に続くリージョンの指定によっては API が用意されていない場合があるため、代表的な 4 リージョンを紹介します。Cognitive Services APIs (westus)Cognitive Services APIs (westus2)Cognitive Services APIs (southcentralus)Cognitive Services APIs (westeurope) REST API の実行には API キーが必要になります。以下のサイトから API キーを取得できます。こちらにないサービスについては、各サービスのクイック スタート ページ等から利用方法を参照ください。Cognitive Services を試す API のテスト実行可能な直リンクを紹介します。Video Indexer, Bing Speech (廃止), Translator Speech (廃止), Translator Text, Bing Search 系 API は含まれません。 Computer Vision v3.2-preview.1 v3.1 Custom Vision Service Training v3.4-Preview Training v3.3 Prediction v3.1 Face v1.0 Form Recognizer (Preview) v2.0 (Preview) Ink Recognizer (Preview) v1.0 (Preview) Speech ServiceSpeech Service はさらに複数のサービス・機能に分かれます。利用可能な REST API の直リンクを以下に列挙します。サービス、機能の一覧は こちら をご確認ください。 Speech to Text REST API v2.0 v3.0 Conversation transcription (Preview) Speaker Recognition Speaker Recognition (Preview) v1.0 (Preview) Language Understanding - LUIS利用可能な REST API の仕様について こちら をご確認ください。 v3.0 オーサリング (preview) v3.0 予測 v2.0 オーサリング v2.0 予測 QnA Maker v4.0 Alterations (Get, Replace) v4.0 Endpoint Keys (Get Keys, Reflesh Keys) v4.0 Endpoint Settings (Get Settings, Update Settings) v4.0 Knowledgebase (Create, Delete, Download, Publish, Replace, Update, etc.) v4.0 Operations (Get Details) v4.0 Runtime (GenerateAnswer, Train) Text Analytics v3.1-preview.2 v3.1-preview.1 v3.0 v2.1 Anomaly Detector (Preview) v1.0 (Preview) Content Moderator Content Moderator API リファレンス Content Moderator (Image, Text) List Management Review (Job, Review, Workflow) Metrics Advisor (Preview) v1.0 (Preview) Personalizer v1.0 変更履歴2020/04/30 created by Mochizuki2020/05/01 modified by Mochizuki2020/10/19 modified by Mochizuki2020/11/02 modified by Mochizuki","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"API","slug":"API","permalink":"https://jpaiblog.github.io/blog/tags/API/"}]},{"title":"ポータルにサインインできない事象について (AADSTS650051)","slug":"error-AADSTS650051","date":"2020-03-06T15:00:00.000Z","updated":"2021-02-04T00:10:56.849Z","comments":true,"path":"2020/03/07/error-AADSTS650051/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/03/07/error-AADSTS650051/","excerpt":"エラー コード AADSTS650051 を含むメッセージが出力し、製品ポータル (www.luis.ai や www.customvision.ai など) へのサインインが失敗する場合の対処方法を紹介します。","text":"エラー コード AADSTS650051 を含むメッセージが出力し、製品ポータル (www.luis.ai や www.customvision.ai など) へのサインインが失敗する場合の対処方法を紹介します。 下記エラーメッセージは (ドメイン名) の DNS 名に紐づく Azure AD のテナントが、管理者不在のバイラル (非管理) テナントと呼ばれる状態 (unmanaged state) であり、それが原因でポータルへサインインできないことを意味します。 ErrorDescription’: ‘AADSTS650051: Using application ‘&lt;ポータル FQDN&gt;’ is currently not supported for your organization &lt;ドメイン名&gt; because it is in an unmanaged state. An administrator needs to claim ownership of the company by DNS validation of &lt;ドメイン名&gt; before the application &lt;ポータル FQDN&gt; can be provisioned.` 類似のサービスに関する記事とはなりますが、詳細と対処方法は以下をご参照ください。 非管理テナントのアカウントで Custom Vision Service のポータルにサインインできない場合の対処方法 この問題は、当該テナントに紐づく (ドメイン名) のドメインの所有確認を行うことで解消されるため、以下のドキュメントの “3. 「管理者になる」メニューを実行します。” まで実施ください。 セルフサービス サインアップで登録されたドメインの対処方法 なお、この問題を解消するだけであれば、手順 4 以降の作業は必要ありませんが、手順 3 を実施する段階で DNS の設定変更が必要となります。Azure AD テナントやドメインの管理者にて確認ください。 関連する公開情報: Azure リソースにログインしようとすると “AADSTS65005” エラーを受け取ります Azure Active Directory の非管理対象ディレクトリを管理者として引き継ぐ 変更履歴2020/03/07 created by Mochizuki","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"AADSTS650051","slug":"AADSTS650051","permalink":"https://jpaiblog.github.io/blog/tags/AADSTS650051/"}]},{"title":"QNA Maker の管理サービス (Cognitive Services リソース) のリージョンについて","slug":"QNA-management-service","date":"2020-03-02T15:00:00.000Z","updated":"2021-02-04T00:10:56.898Z","comments":true,"path":"2020/03/03/QNA-management-service/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/03/03/QNA-management-service/","excerpt":"QNA Maker の管理サービス (Cognitive Services リソース) についてご紹介します。","text":"QNA Maker の管理サービス (Cognitive Services リソース) についてご紹介します。 QnA Maker サービスの全体構成は下記ドキュメントの図を参照ください。 QnA Maker 用の Azure リソース Cognitive Services としてのリソースは、図中の右上の QnA Maker Subscription に相当します。例えば、ポータルを操作して KB を編集した場合、米国西部リージョンにおいてホストされている API 群が呼び出されます (5. Manage KB in portal or via APIs)。この API 群を別リージョンに移行することができないため、こちらのサイト の記載の通り、Cognitive Services リソースは米国西部リージョン固定になります。 米国西部リージョンにある API のバックエンドから、Web Apps 上でホストされた QnA Maker ランタイムに対してアクセスし、Q&amp;A の追加や削除といった操作が行われます。なお、実際の KB のコンテンツ (Q&amp;A、メタデータ等) は Azure Search に保存されており、ユーザーのチャットログは Application Insights に保存されているため、顧客データは米国西部リージョンには保存されません。 ※ 管理サービスで使用する API の詳細は以下サイトを参照ください。 QnA Maker V4.0 KB を公開した後の、ボット等のアプリケーションからの問い合わせ (4. User QnA endpoint in Bot) は GenerateAnswer API が使用されます。これは QnA Maker ランタイム (Web Apps) に対して直接アクセスするため、米国西部リージョンを経由することはありません。 ※ GenerateAnswer API の詳細は以下サイトをご参照ください。 GenerateAnswer API およびメタデータを使って回答を取得する 変更履歴2020/03/03 created by Mochizuki","categories":[{"name":"QNA Maker","slug":"QNA-Maker","permalink":"https://jpaiblog.github.io/blog/categories/QNA-Maker/"}],"tags":[{"name":"管理サービス","slug":"管理サービス","permalink":"https://jpaiblog.github.io/blog/tags/%E7%AE%A1%E7%90%86%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"}]},{"title":"過去ブログについて","slug":"past-blog","date":"2020-01-11T15:00:00.000Z","updated":"2021-02-04T00:10:56.888Z","comments":true,"path":"2020/01/12/past-blog/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/01/12/past-blog/","excerpt":"過去のブログ情報を紹介します。","text":"過去のブログ情報を紹介します。 Cognitive Services Translator Text API の翻訳文字数の確認方法 Open API Testing Console HTTP 401 Access Denied (invalid subscription key) のエラーが発生した場合の切り分け方法 Cognitive Services の料金について LUIS ポータル (www.luis.ai) にサインインできない場合の対処方法 QnA Maker API V4 (一般公開版) の Azure Search に関するよくあるご質問 非管理テナントのアカウントで Custom Vision Service のポータルにサインインできない場合の対処方法 QnA Maker API V4 (一般公開版) のよくあるご質問 Bing Speech API の新規 API キー作成は 10 月 15 日で終了しました Cognitive Services の技術サポートのお問い合わせ方法 Cognitive Services への接続には TLS 1.2 をご利用ください 変更履歴2020/01/12 created by Mochizuki","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"過去ブログ","slug":"過去ブログ","permalink":"https://jpaiblog.github.io/blog/tags/%E9%81%8E%E5%8E%BB%E3%83%96%E3%83%AD%E3%82%B0/"}]},{"title":"jpaiblog について","slug":"about-jpaiblog","date":"2019-12-31T15:00:00.000Z","updated":"2021-02-04T00:10:56.833Z","comments":true,"path":"2020/01/01/about-jpaiblog/","link":"","permalink":"https://jpaiblog.github.io/blog/2020/01/01/about-jpaiblog/","excerpt":"","text":"日本マイクロソフトの Cognitive Serivce に関するサポート情報のブログです。 公開日2020 年 1 月 1 日より公開いたしました。 活動について製品のサポート メンバーによって運用されております。仕様に関する情報やトラブル シューティングの手順、実装におけるワンポイント アドバイスを公開いたします。 留意事項サイトのコンテンツや情報において、可能な限り正確な情報を掲載し、更新するよう努めております。しかしながら、状況の変化や情報が古くなることにより、必ずしもお客様環境に適用できない情報となる場合がございます。恐れ入りますが、予めご留意くださいますようお願い申し上げます。","categories":[{"name":"Cognitive Services","slug":"Cognitive-Services","permalink":"https://jpaiblog.github.io/blog/categories/Cognitive-Services/"}],"tags":[{"name":"はじめに","slug":"はじめに","permalink":"https://jpaiblog.github.io/blog/tags/%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB/"}]}]}